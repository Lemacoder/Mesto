(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p:""};function t(e){e.classList.add("popup_is-opened")}function o(e){e.classList.remove("popup_is-opened")}function r(e){e.querySelector(".popup__close").addEventListener("click",(function(){return o(e)})),document.addEventListener("click",(function(t){t.target.classList.contains("popup_is-opened")&&o(e)})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&o(e)}))}e.d({},{d:()=>h}),document.querySelectorAll(".popup").forEach((function(e){e.classList.add("popup_is-animated")}));var n=document.querySelector(".popup_type_image"),c=n.querySelector(".popup__image"),a=n.querySelector(".popup__caption");r(n);var i=document.querySelector("#card-template").content;function u(e,t,o,r,n){var c=i.querySelector(".places__item").cloneNode(!0);return c.querySelector(".card__image").src=t,c.querySelector(".card__image").alt=e,c.querySelector(".card__title").textContent=e,c.querySelector(".card__likes").textContent=o,c.querySelector(".card__id").textContent=n,1!=r&&c.querySelector(".card__delete-button").classList.add("card__delete-button_inactive"),c}var p=document.querySelector(".popup_type_new-card"),s=document.querySelector(".profile__add-button"),d=p.querySelector(".popup__form");s.addEventListener("click",(function(){t(p)})),d.addEventListener("submit",(function(e){e.preventDefault();var t,r,n=document.querySelector(".popup__input_type_card-name").value,c=document.querySelector(".popup__input_type_url").value;(t=n,r=c,fetch("https://nomoreparties.co/v1/apf-cohort-202/cards",{method:"POST",headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6","Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then((function(e){if(!e.ok)throw new Error("Ошибка добавления карточки: ".concat(e.status));return e.json()})).then((function(e){return e._id})).catch((function(e){console.error("Ошибка при добавлении карточки:",e)}))).then((function(e){h.prepend(u(n,c,0,!0,e))})),o(p)})),r(p);var l=null,_=document.querySelector(".popup_type_edit"),f=document.querySelector(".profile__edit-button");_.querySelector(".popup__form").addEventListener("submit",(function(e){e.preventDefault();var t,r,n=document.querySelector(".popup__input_type_name").value,c=document.querySelector(".popup__input_type_description").value,a=document.querySelector(".profile__title"),i=document.querySelector(".profile__description");a.textContent=n,i.textContent=c,o(_),t=n,r=c,fetch("https://nomoreparties.co/v1/apf-cohort-202/users/me",{method:"PATCH",headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6","Content-Type":"application/json"},body:JSON.stringify({name:t,about:r})}).then((function(e){if(!e.ok)throw new Error("Ошибка обновления пользователя: ".concat(e.status));return e.json()})).catch((function(e){console.error("Ошибка при обновлении данных пользователя:",e)}))})),r(_);const m=e.p+"0863e5bc26221680f1e2.svg";var h=document.querySelector(".places__list");h.addEventListener("click",(function(e){var o,r,i,u;e.target.classList.contains("card__like-button")&&(e.target.classList.contains("card__like-button_is-active")?(e.target.classList.remove("card__like-button_is-active"),o=e.target.parentElement.parentElement.querySelector(".card__id").textContent,r="https://nomoreparties.co/v1/apf-cohort-202/cards/likes/".concat(o),fetch(r,{method:"DELETE",headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6"}}).then((function(e){if(!e.ok)throw new Error("Ошибка удаления лайка: ".concat(e.status));return e.json()})).catch((function(e){console.error("Ошибка при удалении лайка:",e)}))):(e.target.classList.add("card__like-button_is-active"),function(e){var t="https://nomoreparties.co/v1/apf-cohort-202/cards/likes/".concat(e);fetch(t,{method:"PUT",headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6"}}).then((function(e){if(!e.ok)throw new Error("Ошибка добавления лайка: ".concat(e.status));return e.json()})).catch((function(e){console.error("Ошибка при добавлении лайка:",e)}))}(e.target.parentElement.parentElement.querySelector(".card__id").textContent))),e.target.classList.contains("card__delete-button")&&(e.target.closest(".places__item").remove(),function(e){var t="https://nomoreparties.co/v1/apf-cohort-202/cards/".concat(e);fetch(t,{method:"DELETE",headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6"}}).then((function(e){if(!e.ok)throw new Error("Ошибка удаления карточки: ".concat(e.status))})).catch((function(e){console.error("Ошибка при удалении карточки:",e)}))}(e.target.parentElement.querySelector(".card__id").textContent)),e.target.classList.contains("card__image")&&(i=e.target.alt,u=e.target.src,c.src=u,c.alt=i,a.textContent=i,t(n))})),document.querySelector(".header__logo").src=m,f.addEventListener("click",(function(){var e=document.querySelector(".profile__title").textContent,o=document.querySelector(".profile__description").textContent;document.querySelector(".popup__input_type_name").value=e,document.querySelector(".popup__input_type_description").value=o,t(_)})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll(".popup__input")),o=e.querySelector(".popup__button");t.forEach((function(r){r.addEventListener("input",(function(){!function(e,t){t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("popup__input_type_error"),o.classList.remove("popup__input-error_active"),o.textContent=""}(e,t):function(e,t,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("popup__input_type_error"),r.textContent=o,r.classList.add("popup__input-error_active")}(e,t,t.validationMessage)}(e,r),function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.classList.remove("popup__button_inactive"):t.classList.add("popup__button_inactive")}(t,o)}))}))}(e)})),fetch("https://nomoreparties.co/v1/apf-cohort-202/users/me",{headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6"}}).then((function(e){if(!e.ok)throw new Error("Ошибка загрузки пользователя: ".concat(e.status));return e.json()})).then((function(e){document.querySelector(".profile__image").style.backgroundImage="url(".concat(e.avatar,")"),document.querySelector(".profile__title").textContent=e.name,document.querySelector(".profile__description").textContent=e.about,l=e._id})).catch((function(e){console.error("Ошибка при загрузке данных пользователя:",e)})),fetch("https://nomoreparties.co/v1/apf-cohort-202/cards",{headers:{authorization:"c6f39b35-acde-4bea-9a76-beb0de6a82d6"}}).then((function(e){if(!e.ok)throw new Error("Ошибка загрузки карточек: ".concat(e.status));return e.json()})).then((function(e){h.innerHTML="";for(var t=0;t<e.length;t++){var o=e[t].owner._id===l;h.append(u(e[t].name,e[t].link,e[t].likes.length,o,e[t]._id))}})).catch((function(e){console.error("Ошибка при загрузке карточек:",e)}))})();